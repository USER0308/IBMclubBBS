{% extends "base_with_header_footer.html" %}
    {% block main-left %}
        <style>
            #main{
                background: slategrey;
            }
            #main .main-left{
                width: 25%;
                background: #bfccff;
                padding-right:0%;
            }
            #main .main-right{
                    width:100%;
                    height:10px;
                    /*background:green;*/
                    /*float:right;*/
            }
        </style>

        {% regroup query_set by msg_from as msg_list %}
        <!--<p>{{ grouped }}</p>-->
            <div class="list-group">
                {% for sender in msg_list %}
                <!--<p>{{ sender }}</p>-->
                <button type="button" class="list-group-item"><span class="badge" id="message_num">{{ sender.list|length }}</span>from: {{ sender.grouper }}</button>
                {% endfor %}
            </div>
        <script>
            var messages;
            $(window).on('load',function () {
                $('button').click(function () {
                    var str = $(this).text()
                    var index = str.indexOf(": ")
                    var sub = str.substring(index+2)
                    var arr = new Array("/mysite/get_messages/",sub,"/")
                    var full_url = arr.join("")
                    //alert(full_url)
                    $.ajax({
                        url: full_url,
                        type: 'POST',
                        data: {'csrfmiddlewaretoken': '{{ csrf_token }}'},
                        dataType: 'json',
                        timeout: 3000,
                        success: function(result) {
                            receive_messages = result.receive_messages
                            send_messages = result.send_messages
                            receive_messages = JSON.parse(receive_messages)
                            send_messages = JSON.parse(send_messages)
                            console.log(receive_messages)
                            console.log(send_messages)
                            //alert("success")
                            insertMessage(receive_messages,send_messages)
                            //
                            document.getElementById("chat_dialog").style.display="block";
                        }
                    })
                })
                function insertMessage(receive_messages,send_messages) {

                }
            })
        </script>
        <!--{% regroup cities by country as country_list %}-->

        <!--<ul>-->
        <!--{% for sender in msg_list %}-->
            <!--<li>{{ sender.grouper }}-->
            <!--<ul>-->
                  <!--<li>{{ sender.list|length }}</li>-->
            <!--</ul>-->
            <!--</li>-->
        <!--{% endfor %}-->
        <!--</ul>-->

    {% endblock %}
    {% block main-middle %}
        <style>
            #main .main-middle{
                /*background:pink;*/
                margin-left:5%;
                width:68%;
            }
        </style>
        <div class="main-middle-top" style="background-color: black">
            <nav class="navbar nav-default nav-static-top">
                <div >
                    <p style="text-align: center;margin-top: 10px;color: whitesmoke">someone</p>
                </div>
            </nav>
        </div>
    {% block chat_dialog %}
        {% include "chat_dialog_templates.html" %}
    {% endblock %}
{% endblock %}